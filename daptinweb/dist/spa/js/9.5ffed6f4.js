(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[9],{2711:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"row"},[a("div",{staticClass:"col-10"},[e.tableSchema?a("div",{staticClass:"col-10 q-pa-md"},[a("table-editor",{attrs:{table:e.tableSchema},on:{deleteRelation:e.deleteTableRelation,deleteColumn:e.deleteTableColumn,save:e.saveTable}})],1):e._e()])])])},o=[],l=(a("8e6e"),a("8a81"),a("ac6a"),a("cadf"),a("06db"),a("456d"),a("28a5"),a("c47a")),c=a.n(l),i=a("2f62");a("a633");function r(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function s(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?r(Object(a),!0).forEach((function(t){c()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var h={name:"CreateTable",methods:s({deleteTableRelation:function(e){console.log("Delete relation",e)},deleteTableColumn:function(e){console.log("Delete column",e),this.executeAction({tableName:"world",actionName:"remove_column",params:{world_id:"",column_level:""}}).then((function(e){console.log("Update table",e),setTimeout((function(){that.$q.notify("Updated table structure, refreshing schema"),that.refreshTableSchema(table.TableName).then((function(){that.$q.notify("Schema refreshed"),that.$q.loading.hide()})).catch((function(e){that.$q.notify("Failed to refresh schema "+e),that.$q.loading.hide()}))}),2e3)})).catch((function(e){that.$q.notify("Failed to create "+e),that.$q.loading.hide()}))},saveTable:function(e){var t=this;if(0!==e.ColumnModel.length){for(var a=0;a<e.ColumnModel.length;a++){var n=e.ColumnModel[a];if(n.ColumnType.indexOf(" - ")>-1){var o=n.ColumnType.split(" - ");n.ColumnType=o[0],n.DataType=o[1],e.ColumnModel[a]=n}}console.log("Table data",e);var l=e.Relations;this.$q.notify("Updating table structure "+e.TableName),t.$q.loading.show(),this.executeAction({tableName:"world",actionName:"upload_system_schema",params:{schema_file:[{name:"empty.json",file:"data:application/json;base64,"+btoa(JSON.stringify({Tables:[{TableName:e.TableName,Columns:e.ColumnModel}],Relations:l})),type:"application/json"}]}}).then((function(a){console.log("Update table",a),setTimeout((function(){t.$q.notify("Updated table structure, refreshing schema"),t.refreshTableSchema(e.TableName).then((function(){t.$q.notify("Schema refreshed"),t.$q.loading.hide()})).catch((function(e){t.$q.notify("Failed to refresh schema "+e),t.$q.loading.hide()}))}),2e3)})).catch((function(e){t.$q.notify("Failed to create "+e),t.$q.loading.hide()}))}else this.$q.notify("Please add columns")},loadTable:function(){var e=this;e.tableSchema=null;var t=this.$route.params.tableName;console.log("Edit table",t),t?this.getTableSchema(t).then((function(t){e.tableSchema=t,console.log("Schema",e.tableSchema)})):this.setSelectedTable(this.$route.params.tableName)}},Object(i["b"])(["getTableSchema","executeAction","refreshTableSchema"])),data:function(){return{text:"",tableSchema:null}},mounted:function(){this.loadTable()},watch:{},computed:s({},Object(i["c"])(["drawerLeft"]),{},Object(i["d"])([]))},u=h,d=a("2877"),m=a("eebe"),b=a.n(m),f=a("9404"),p=a("4983"),g=Object(d["a"])(u,n,o,!1,null,null,null);t["default"]=g.exports;b()(g,"components",{QDrawer:f["a"],QScrollArea:p["a"]})}}]);